e_mlogit<-function(explaining=0){
if(explaining==0) {
cat("  \033[1;33m## multinomial logit 분석 ------ \033[0m", '\n')
cat("  library(nnet); library(stargazer); library(aj412s)  ", '\n')
cat("  df<-BasicData  ", '\n')
cat("  df<-df[complete.cases(df), ]  ", '\n')
cat("  df$debt3<-as.factor(df$debt3)  ", '\n')
cat("  df$debt3 <- relevel(df$debt3, ref = '0')  # Base는 부채가 없음(0) ", '\n')  
cat("  \033[0;36m#  multinom 사용시 maxit는 'not converged'경고문이 있을 경우,  \033[0m", '\n')
cat("  \033[0;36m#  maxit를 90000같은 큰 값으로 설정한 후 재분석합니다 \033[0m", '\n')
cat("  re<-multinom(debt3 ~ conv + satprice + age + gender, data=df, maxit = 90000)  ", '\n')
cat("  stargazer(re, type='text') ", '\n')
cat(" ", '\n')
cat("  \033[1;33m## 오즈비 계산 및 설명 ------   \033[0m", '\n')
cat("  \033[0;36m#  mcoef<-coef(re)   \033[0m", '\n')
cat("  \033[0;36m#  exp(mcoef)  #오즈비(Odds ratio) 계산 \033[0m", '\n')
cat("  \033[0;36m#  exp(mcoef)-1  #오즈비(Odds ratio) 해석 \033[0m", '\n')
cat("  \033[0;36m#  오즈비(Odds ratio) 해석방법은 오즈비에서 1을 뺀 나머지로 해석합니다 \033[0m", '\n')
cat("  \033[0;36m#  conv가 1단위 증가하면 ...  \033[0m", '\n')
cat("  \033[0;36m#  'collateral부채'를 보유할 확률은 '부채가 없을 확률'에 비해 86.26%(=0.1373-1) 낮다  \033[0m", '\n')
cat("  \033[0;36m#  'credit부채'를 보유할 확률은 '부채가 없을 확률'에 비해 87.95%(=0.12048-1) 낮다  \033[0m", '\n')
cat("  \033[0;36m#  satprice가 1단위 증가하면 ...  \033[0m", '\n')
cat("  \033[0;36m#  'collateral부채'를 보유할 확률은 '부채가 없을 확률'에 비해 40.11%(=1.4011-1) 높다  \033[0m", '\n')
cat(" ", '\n')
cat("  \033[1;33m## 확률계산 ------ \033[0m", '\n')
cat("  mcoef<-coef(re) ", '\n')
cat("  inputdata<-c(1, 3, 2, 30, 1)   # 1=상수항, 3=conv, 2=satprice, 30=age, 1=gender ", '\n')
cat("  y2<-sum(mcoef[1,]*inputdata)  ", '\n')
cat("  y3<-sum(mcoef[2,]*inputdata)  ", '\n')
cat("  y4<-sum(mcoef[3,]*inputdata)  ", '\n')
cat("  denum <- ( 1 + exp(y2) + exp(y3) + exp(y4) )  ", '\n')
cat("  prob.부채없음 <- 1/denum ", '\n')
cat("  prob.담보부채 <- exp(y2)/denum  ", '\n')
cat("  prob.신용부채 <- exp(y3)/denum  ", '\n')
cat("  prob.담보및신용부채 <- exp(y4)/denum  ", '\n')
cat(" ", '\n')
cat("  \033[1;33m ## Simulation DGP ------  \033[0m", '\n')
cat("  \033[1;33m # 시뮬레이션을 위한 함수. 수정할 필요 없음. 아래 코드를 콘솔화면에 Copy & Paste하시오 ------  \033[0m", '\n')
cat("  \033[1;33m # Y_PROB에 저장되는 확률은 '제외된 종속변수의 확률', 그리고 리포팅된 종속변수 순으로...   \033[0m", '\n')
cat("  \033[1;33m # 명령문: probtmp<-mlogit_simul(분석결과, simulation자료)  \033[0m", '\n')
cat(" ", '\n')
cat("  \033[0;36m mlogit_simul<-function(result_name, simul_data){    \033[0m", '\n')
cat("  \033[0;36m     mcoef<-coef(result_name)    \033[0m", '\n')
cat("  \033[0;36m     n<-nrow(simul_data)    \033[0m", '\n')
cat("  \033[0;36m     n_dependent <- nrow(mcoef)+1       \033[0m", '\n')
cat("  \033[0;36m     Y_PROB <- matrix(NA, ncol=n_dependent, nrow=n)       \033[0m", '\n')
cat(" ", '\n')
cat("  \033[0;36m     prob_simul <- function(mcoef, tmp_simul){       \033[0m", '\n')
cat("  \033[0;36m       r=c()     \033[0m", '\n')
cat("  \033[0;36m      ncount <- nrow(mcoef)        \033[0m", '\n')  
cat("  \033[0;36m      y_index<-rep(NA, ncount )    \033[0m", '\n')
cat("  \033[0;36m         for(i in 1:ncount){       \033[0m", '\n')
cat("  \033[0;36m            y_index[i]<-sum(mcoef[i,]*tmp_simul)     \033[0m", '\n')
cat("  \033[0;36m            r=c(r, exp(y_index[i]) )     \033[0m", '\n')
cat("  \033[0;36m            }     \033[0m", '\n')
cat("  \033[0;36m     denum<-(1 + sum(r) )     \033[0m", '\n')
cat("  \033[0;36m     r<-c(1,r)     \033[0m", '\n')
cat("  \033[0;36m     prob_y=c()     \033[0m", '\n')
cat("  \033[0;36m          for(i in 1:length(r)) {  \033[0m", '\n')   
cat("  \033[0;36m             prob_y =c(prob_y, r[i]/denum ) }     \033[0m", '\n')
cat("  \033[0;36m             return(prob_y)     \033[0m", '\n')
cat("  \033[0;36m     }     \033[0m", '\n')
cat(" ", '\n')
cat("  \033[0;36m     for(i in 1:n){     \033[0m", '\n')
cat("  \033[0;36m          tmp_simul<-c(1, as.numeric( simul_data[i , ] ) )  \033[0m", '\n')
cat("  \033[0;36m          Y_PROB[i, ]=prob_simul(mcoef, tmp_simul)  \033[0m", '\n')
cat("  \033[0;36m         }   \033[0m", '\n')
cat("  \033[0;36m   return(Y_PROB) \033[0m", '\n')
cat("  \033[0;36m } \033[0m", '\n')
cat(" ", '\n')
cat("  \033[0;33m## ggplot으로 그래프 그리기 -----------------  \033[0m", '\n')
cat("   re<-multinom(debt3 ~ conv + satprice + age + gender, data=df) ", '\n')
cat(" ", '\n')
cat("  \033[0;33m## conv값을 변경시켰을 때의 확률변화를 보자 ------  \033[0m", '\n')
cat("   conv시뮬레이션 <- seq( min(df$conv), max(df$conv), by=0.5)  ", '\n')
cat("   simul_data <- as.data.frame( cbind( conv시뮬레이션, median(df$satprice), median(df$age), 0) ) ", '\n')
cat(" ", '\n')
cat("  \033[0;36m library(ggplot2)   \033[0m", '\n')
cat("   probtmp<-mlogit_simul(re, simul_data)  ", '\n')
cat("   probtmp<-as.data.frame(cbind(conv시뮬레이션, probtmp))  ", '\n')
cat("  \033[0;36m p <- ggplot(probtmp, aes(x = probtmp[,1])) +     \033[0m", '\n')
cat("  \033[0;36m      geom_line(aes(y = probtmp[,2]), color = 'navy') +  # 첫 번째 선     \033[0m", '\n')
cat("  \033[0;36m      geom_line(aes(y = probtmp[,3]), color = 'orange') +  # 첫 번째 선     \033[0m", '\n')
cat("  \033[0;36m      geom_line(aes(y = probtmp[,4]), color = 'black') +  # 두 번째 선     \033[0m", '\n')
cat("  \033[0;36m      geom_line(aes(y = probtmp[,5]), color = 'olivedrab')  # 세 번째 선     \033[0m", '\n')
cat(" ", '\n')
}}
